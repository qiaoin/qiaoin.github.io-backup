<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>分布式系统导入 | 在桥边</title>
    <meta name="description" content="偷得浮生半日闲">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.932e3e91.css" as="style"><link rel="preload" href="/assets/js/app.e709e50c.js" as="script"><link rel="preload" href="/assets/js/2.aed79e5e.js" as="script"><link rel="preload" href="/assets/js/60.b23c8bc9.js" as="script"><link rel="prefetch" href="/assets/js/10.ebac5325.js"><link rel="prefetch" href="/assets/js/11.7b2d672a.js"><link rel="prefetch" href="/assets/js/12.54ea6fcf.js"><link rel="prefetch" href="/assets/js/13.db76fbea.js"><link rel="prefetch" href="/assets/js/14.fa058a50.js"><link rel="prefetch" href="/assets/js/15.9a7abe23.js"><link rel="prefetch" href="/assets/js/16.c2552b58.js"><link rel="prefetch" href="/assets/js/17.92650ebe.js"><link rel="prefetch" href="/assets/js/18.1329c666.js"><link rel="prefetch" href="/assets/js/19.856e1bd6.js"><link rel="prefetch" href="/assets/js/20.ae008e83.js"><link rel="prefetch" href="/assets/js/21.bf7a5edb.js"><link rel="prefetch" href="/assets/js/22.9037bd3b.js"><link rel="prefetch" href="/assets/js/23.e2b0062c.js"><link rel="prefetch" href="/assets/js/24.7a5dc9db.js"><link rel="prefetch" href="/assets/js/25.51d89d5c.js"><link rel="prefetch" href="/assets/js/26.05fca636.js"><link rel="prefetch" href="/assets/js/27.53049f31.js"><link rel="prefetch" href="/assets/js/28.4ec6e500.js"><link rel="prefetch" href="/assets/js/29.3710e311.js"><link rel="prefetch" href="/assets/js/3.ce4ee92b.js"><link rel="prefetch" href="/assets/js/30.113a865b.js"><link rel="prefetch" href="/assets/js/31.32df48b4.js"><link rel="prefetch" href="/assets/js/32.6a9518d9.js"><link rel="prefetch" href="/assets/js/33.22fc30e7.js"><link rel="prefetch" href="/assets/js/34.dc080c4a.js"><link rel="prefetch" href="/assets/js/35.b9d1347c.js"><link rel="prefetch" href="/assets/js/36.012e0f79.js"><link rel="prefetch" href="/assets/js/37.52431a51.js"><link rel="prefetch" href="/assets/js/38.6bded00e.js"><link rel="prefetch" href="/assets/js/39.238f7705.js"><link rel="prefetch" href="/assets/js/4.796409a6.js"><link rel="prefetch" href="/assets/js/40.66e360c2.js"><link rel="prefetch" href="/assets/js/41.58481556.js"><link rel="prefetch" href="/assets/js/42.f8d39693.js"><link rel="prefetch" href="/assets/js/43.01ee4634.js"><link rel="prefetch" href="/assets/js/44.8481426f.js"><link rel="prefetch" href="/assets/js/45.aa1a9e0d.js"><link rel="prefetch" href="/assets/js/46.b9a5cb66.js"><link rel="prefetch" href="/assets/js/47.6963d786.js"><link rel="prefetch" href="/assets/js/48.b7224a2c.js"><link rel="prefetch" href="/assets/js/49.98dead63.js"><link rel="prefetch" href="/assets/js/5.ab04d8a1.js"><link rel="prefetch" href="/assets/js/50.d290680d.js"><link rel="prefetch" href="/assets/js/51.9317bcc1.js"><link rel="prefetch" href="/assets/js/52.56ac34b2.js"><link rel="prefetch" href="/assets/js/53.84b9fe5a.js"><link rel="prefetch" href="/assets/js/54.d134d158.js"><link rel="prefetch" href="/assets/js/55.09360f53.js"><link rel="prefetch" href="/assets/js/56.b88937d0.js"><link rel="prefetch" href="/assets/js/57.9781ff09.js"><link rel="prefetch" href="/assets/js/58.8632f2c4.js"><link rel="prefetch" href="/assets/js/59.0b61fe78.js"><link rel="prefetch" href="/assets/js/6.a8f689ef.js"><link rel="prefetch" href="/assets/js/61.99305fe8.js"><link rel="prefetch" href="/assets/js/62.b81b7ba9.js"><link rel="prefetch" href="/assets/js/63.27df456b.js"><link rel="prefetch" href="/assets/js/64.fa3ffb7b.js"><link rel="prefetch" href="/assets/js/65.c9d34a2b.js"><link rel="prefetch" href="/assets/js/66.2000d26a.js"><link rel="prefetch" href="/assets/js/67.aabdb00e.js"><link rel="prefetch" href="/assets/js/68.9ccf045a.js"><link rel="prefetch" href="/assets/js/69.0e0e4de8.js"><link rel="prefetch" href="/assets/js/7.83edc202.js"><link rel="prefetch" href="/assets/js/70.aef1292b.js"><link rel="prefetch" href="/assets/js/8.1d8b6d49.js"><link rel="prefetch" href="/assets/js/9.c0d52356.js">
    <link rel="stylesheet" href="/assets/css/0.styles.932e3e91.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">在桥边</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/basic/algorithm/" class="nav-link">
  算法与数据结构
</a></li><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/basic/database/" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/basic/compiler/" class="nav-link">
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/basic/math/" class="nav-link">
  数学
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/" class="nav-link">
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lang/cpp/" class="nav-link">
  C++
</a></li><li class="dropdown-item"><!----> <a href="/lang/go/" class="nav-link">
  Go
</a></li><li class="dropdown-item"><!----> <a href="/lang/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/lang/py/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><a href="/system/" class="nav-link router-link-active">
  分布式系统
</a></div><div class="nav-item"><a href="/source/" class="nav-link">
  源码阅读
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  乱翻书
</a></div> <a href="https://github.com/qiaoin/qiaoin.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/basic/algorithm/" class="nav-link">
  算法与数据结构
</a></li><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/basic/database/" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/basic/compiler/" class="nav-link">
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/basic/math/" class="nav-link">
  数学
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/" class="nav-link">
  Linux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/lang/cpp/" class="nav-link">
  C++
</a></li><li class="dropdown-item"><!----> <a href="/lang/go/" class="nav-link">
  Go
</a></li><li class="dropdown-item"><!----> <a href="/lang/js/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/lang/py/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><a href="/system/" class="nav-link router-link-active">
  分布式系统
</a></div><div class="nav-item"><a href="/source/" class="nav-link">
  源码阅读
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  乱翻书
</a></div> <a href="https://github.com/qiaoin/qiaoin.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MIT 6.824 课程笔记</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/1-introduction.html" class="active sidebar-link">分布式系统导入</a></li><li><a href="/system/2-rpc-and-threads.html" class="sidebar-link">RPC 和线程</a></li><li><a href="/system/3-gfs.html" class="sidebar-link">分布式文件系统</a></li><li><a href="/system/4-primary-backup-replication.html" class="sidebar-link">Primary Backup Replication</a></li><li><a href="/system/5-go-threads-and-raft.html" class="sidebar-link">Go, Threads, and Raft</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>MIT 6.824 实验</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/lab1-mapreduce.html" class="sidebar-link">Lab 1 - MapReduce</a></li><li><a href="/system/lab2-raft.html" class="sidebar-link">Lab 2 - Raft</a></li><li><a href="/system/lab3-kv-raft.html" class="sidebar-link">Lab 3 - KV Raft</a></li><li><a href="/system/lab4-sharded-kv.html" class="sidebar-link">Lab 4 - Sharded KV</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>什么是分布式系统？</p> <p>The core of a distributed system is a set of cooperating computers that are communicating with each other over network to get some coherent tasks done</p> <ul><li>storage for big websites</li> <li>big data computations, such as MapReduce</li> <li>peer-to-peer file sharing</li></ul> <ol><li>high-performance, achieve some sort of parallelism</li> <li>fault tolerance</li> <li>physical reasons, some problems are just naturally spread out in space</li> <li>achieve some sort of security goal, isolated</li></ol> <ul><li>concurrency，并发，</li> <li>partial failures，分布式系统+网络</li> <li>performance，高性能如何达到</li></ul> <p>读论文应该要关注什么</p> <ul><li>What the basic problems are?</li> <li>What ideas people have had that might or might not be useful in solving distributed system problems?</li> <li>Looking into implementation details in some of these papers because a lot of this has to do with actual construction of software based systems</li> <li>Looking at evaluations. How fault tolerant their systems by measuring. How much performance or whether they got performance improvement at all</li></ul> <p>read a paper rapidly and skip over the parts that maybe aren't that important, and focus on teasing out the important ideas</p> <p>Three infrastructure:</p> <ul><li>storage -- a very well-defined and useful abstraction</li> <li>communication -- 6.829</li> <li>commputation -- MapReduce</li></ul> <p>the dream is to build an interface that looks like an application, it's a non distributed storage system just like a file system, every one knows how to program and has a pretty simple model semantics</p> <p>=&gt; build interfaces that look and act just like non distributed storage and computation systems, but they are actually extremely high performance, fault tolerant, distributed systems underneath</p> <p>conventient abstractions for application programmers</p> <p>Abstrations 抽象</p> <p>Implementation tools</p> <ol><li>PC(Remote Procedure Call), mask the fact that we're communicating over an unreliable network</li> <li>threads</li> <li>concurrency</li></ol> <p>Performance 性能</p> <ul><li>scalability, scalable speed-up</li> <li>bottlenect is moving</li></ul> <p>很难，需要精密的设计</p> <p>Fault tolerance</p> <p>在分布式系统中，每天可能会有三台计算机出现错误</p> <p>系统不再稳定</p> <p>there is always failures</p> <p>different kinds of failures that can occur</p> <p>we must hide the failures from application programmers or masks them</p> <p>Availability - under certain set of failures, we're going to continue providing service</p> <p>Recoverability - if something goes wrong,</p> <ul><li>non-volatile storage 非易失存储，when something goes wrong, we can store a check point or a log of the state of the system</li> <li>replication, 复制</li></ul> <p>Consistency 一致性</p> <ul><li>strong consistency - gets see most recent puts, requiering expensive communication</li> <li>weak consistency - avoid communication as much as possible</li></ul> <p>we use the replication for fault tolerance, then we really want the replicas to have independent failure probability, to have uncorrelated failure</p> <p>In the search for making replicas as independent and failure as possible in order to get decent fault tolerance, people would love to put different replicas as far apart as possible like in different cities or maybe on opposite sides of the continent</p> <p>MapReduce</p> <p>a framework that would make it easy for non specialists to be able to write and run giant distributed computations</p> <p>map(): takes the input data and produce a list of key-value pairs as output (intermediate output stores on local disk)
reduce(): arrange for one call to reduce() for every key that occurred in any of the map() output, fetch from every worker all of the instances of the key that it's responsible for that the master has told it to be responsible for, and once it collects all of that data, then it can call reduce()</p> <p>the MapReduce framework collects together all instances from all maps of each key word</p> <p>job -- map tasks and reduce tasks</p> <p>wordcount 例子</p> <p>map emit - produce files on the map workers local disk, accumulating all the keys and values produced by the maps run on that worker
reduce emit - write the output to a file in a cluster file service (Google File System - GFS)</p> <p>Input file 1 --&gt;  Map() --&gt; intermediate output  --&gt; Reduce()</p> <p>Input file 2 --&gt;  Map() --&gt; intermediate output  --&gt; Reduce()</p> <p>Input file 3 --&gt;  Map() --&gt; intermediate output  --&gt; Reduce()</p> <p>what does this arrow here actually involve?</p> <p>the answer changes over the year as Google involve this system</p> <p>MapReduce worker process has to go off and talk across the network to the correct GFS server or maybe servers that store it's part of the input, and fetch it over the network to the MapReduce worker machine in order to pass the map()</p> <p>in the world of this paper in 2004, the most constraining bottleneck in their MapReduce system was network throughput, because they were running on a network</p> <p>they played a bunch of tricks to avoid sending stuff over the network when they possibly could avoid it. One of them was they would run the GFS servers and the MapReduce workers on the same set of machines.</p> <p>the arrow, by default, was actually local read from the local disk and did not involve the network</p> <p>Almost all the maps would be run the very same machine and stored the data, thus saving them vast amount of time that they would otherwise had to wait to move the input data across the network</p> <p>Map stores this output on the local disk of the machine that you run the map on, so again storing the output of the map does not require network communication</p> <p>In order to group together all of the values associated with the given key and pass them to a single invocation to produce on some machine. This is going to require network communication.</p> <p>suffle phrase -- really requires moving every piece of data across the network from the map that produced it to the reduce that we need it.</p> <p>it is the expensive part of the MapReduce.</p> <p>batch approach v.s. streaming process</p> <p>the reduce output can be the input of another MapReduce</p> <p>get the output of each reduce to the GFS server</p> <p>MapReduce 过程的主要网络耗时：
1）shuffle 过程
2）reduce 的结果写 GFS（GFS 会做三备份）</p> <p>data center has only one root switch in 2004</p> <p>In 2020, some modern data center has many root switches, and each rack switch has a connection to each of these replicated root switches, and the traffice is split up among the root switches, so modern data center networks have far more network throughput</p> <blockquote><p>如何判断一个操作是不是 MapReduce 操作呢？或者说如何判断一个过程是否适合 MapReduce 实现？</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/system/2-rpc-and-threads.html">
        RPC 和线程
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e709e50c.js" defer></script><script src="/assets/js/2.aed79e5e.js" defer></script><script src="/assets/js/60.b23c8bc9.js" defer></script>
  </body>
</html>
